<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Control Remoto Marcador TV</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      background: #222; 
      color: #fff; 
      text-align: center; 
      padding: 40px; 
      margin: 0;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    button { 
      margin: 12px; 
      padding: 18px 32px; 
      font-size: 1.5rem; 
      border-radius: 8px; 
      border: none; 
      background: #1e90ff; 
      color: #fff; 
      cursor: pointer; 
      min-width: 200px;
    }
    button:hover { background: #43b3ae; }
    button:active { transform: scale(0.95); }
    button.success { background: #2ecc40; }
    button.warning { background: #ff851b; }
    button.danger { background: #dc3545; }
    h1 { margin-bottom: 32px; }
    .section { 
      margin: 30px 0; 
      padding: 20px;
      border: 1px solid #444;
      border-radius: 10px;
    }
    .section h2 { 
      margin-top: 0; 
      color: #1e90ff;
    }
    #status { 
      margin-top: 32px; 
      font-size: 1.2rem; 
      padding: 10px;
      border-radius: 5px;
      background: #333;
    }
    .status-connected { color: #2ecc40; }
    .status-error { color: #dc3545; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üèì Control Remoto Marcador TV</h1>
    
    <div class="section">
      <h2>Controles de Puntuaci√≥n</h2>
      <button class="success" onclick="sendApiCmd('/api/punto1')">+ Punto Jugador 1</button>
      <button class="success" onclick="sendApiCmd('/api/punto2')">+ Punto Jugador 2</button>
      <br>
      <button class="warning" onclick="sendApiCmd('/api/restar1')">- Punto Jugador 1</button>
      <button class="warning" onclick="sendApiCmd('/api/restar2')">- Punto Jugador 2</button>
    </div>

    <div class="section">
      <h2>Controles de Juego</h2>
      <button onclick="sendApiCmd('/api/cambioSaque')">üîÑ Cambio de Saque</button>
      <button onclick="sendApiCmd('/api/cambioCancha')">üèüÔ∏è Cambio de Cancha</button>
      <br>
      <button class="danger" onclick="confirmReset()">üîÑ Reset Juego</button>
    </div>

    <div class="section">
      <h2>Enlaces</h2>
      <button onclick="openMarcador()">üì∫ Ver Marcador</button>
      <button onclick="testConnection()">üîß Test Conexi√≥n</button>
    </div>

    <div id="status">Cargando...</div>
  </div>

  <script>
    // Funci√≥n para enviar comandos a la API REST
    async function sendApiCmd(endpoint) {
      try {
        updateStatus('Enviando comando...', 'info');
        const response = await fetch(endpoint, { 
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          }
        });
        
        if (response.ok) {
          const data = await response.json();
          updateStatus(`‚úÖ ${data.action} ejecutado correctamente`, 'success');
          console.log('Comando enviado:', data);
        } else {
          updateStatus(`‚ùå Error: ${response.status}`, 'error');
        }
      } catch (error) {
        updateStatus(`‚ùå Error de conexi√≥n: ${error.message}`, 'error');
        console.error('Error:', error);
      }
    }

    // Funci√≥n para confirmar reset
    function confirmReset() {
      if (confirm('¬øSeguro que quieres resetear el juego?')) {
        sendApiCmd('/api/reset');
      }
    }

    // Funci√≥n para abrir marcador
    function openMarcador() {
      const url = `http://${window.location.hostname}:5173`;
      window.open(url, '_blank');
    }

    // Funci√≥n para test de conexi√≥n
    async function testConnection() {
      try {
        updateStatus('Probando conexi√≥n...', 'info');
        const response = await fetch('/api/info');
        if (response.ok) {
          const data = await response.json();
          updateStatus(`‚úÖ Conectado - Plataforma: ${data.platform} | Modo: ${data.mode}`, 'success');
        } else {
          updateStatus(`‚ùå Error de conexi√≥n: ${response.status}`, 'error');
        }
      } catch (error) {
        updateStatus(`‚ùå Error: ${error.message}`, 'error');
      }
    }

    // Funci√≥n para actualizar estado
    function updateStatus(message, type) {
      const status = document.getElementById('status');
      status.textContent = message;
      status.className = type === 'success' ? 'status-connected' : 
                        type === 'error' ? 'status-error' : '';
    }

    // Inicializar al cargar la p√°gina
    window.onload = function() {
      updateStatus('Panel de control cargado', 'info');
      // Test inicial de conexi√≥n
      setTimeout(testConnection, 1000);
    };

    // Atajos de teclado
    document.addEventListener('keydown', function(event) {
      switch(event.key) {
        case '1':
          sendApiCmd('/api/punto1');
          break;
        case '2':
          sendApiCmd('/api/punto2');
          break;
        case 's':
        case 'S':
          sendApiCmd('/api/cambioSaque');
          break;
        case 'c':
        case 'C':
          sendApiCmd('/api/cambioCancha');
          break;
      }
    });

    // Mostrar atajos
    console.log('Atajos de teclado:');
    console.log('1 = Punto Jugador 1');
    console.log('2 = Punto Jugador 2'); 
    console.log('S = Cambio de Saque');
    console.log('C = Cambio de Cancha');
  </script>
</body>
</html>
